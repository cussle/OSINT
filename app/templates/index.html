<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OUT OF SITE</title>

    <!-- ğŸŒ ì™¸ë¶€ CSS íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- ì§€ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
</head>
<body>
    <h1>ğŸŒ G O O S E</h1>
    <h2> GET OUT OF SITE</h2>

    <form method="POST">
        <input type="text" name="domain" placeholder="ë„ë©”ì¸ ì…ë ¥ (ì˜ˆ: naver.com)" required>
        <button type="submit">ğŸ” ì¡°íšŒ</button>
    </form>

    {% if data %}
    <!-- ğŸ“Œ ì •ë³´ + ì§€ë„ ì»¨í…Œì´ë„ˆ -->
    <div class="container">
        <!-- ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼ -->
        <div class="result-box">
            <h2>ğŸ“¡ ë„ë©”ì¸ ë¶„ì„ ê²°ê³¼</h2>
            <p>ğŸŒ <strong>ë„ë©”ì¸:</strong> {{ data["ë„ë©”ì¸"] }}</p>
            <p>ğŸŒ <strong>ë“±ë¡êµ­ê°€:</strong> {{ data["ë“±ë¡êµ­ê°€"] }}</p>
            <p>ğŸ¢ <strong>ë“±ë¡ê¸°ê´€:</strong> {{ data["ë“±ë¡ê¸°ê´€"] }}</p>
            <p>ğŸ“Œ <strong>ë„ë©”ì¸ ì—°ë ¹:</strong> {{ data["ë„ë©”ì¸ ì—°ë ¹"] }}</p>
            <p>ğŸ“ <strong>ë“±ë¡ ê¸°ê°„:</strong> {{ data["ë“±ë¡ ê¸°ê°„"] }}</p>
            <p>ğŸ”’ <strong>ê°œì¸ì •ë³´ ë³´í˜¸:</strong> {{ data["ê°œì¸ì •ë³´ ë³´í˜¸ ì—¬ë¶€"] }}</p>
            <p>ğŸ“§ <strong>ì´ë©”ì¼:</strong> {{ data["ì´ë©”ì¼"] }}</p>
            <p>ğŸ“ <strong>ì£¼ì†Œ:</strong> {{ data["ì£¼ì†Œ"] }}</p>

            <h3>ğŸ”— ë„¤íŠ¸ì›Œí¬ ì •ë³´</h3>
            <p>ğŸŒ <strong>IP ì£¼ì†Œ:</strong> {{ data["IP ì£¼ì†Œ"] }}</p>

            <h3>ğŸ” DNS ì •ë³´</h3>
            <p>ğŸ“Œ <strong>A ë ˆì½”ë“œ:</strong> {{ data["A ë ˆì½”ë“œ"] }}</p>
            <p>ğŸ“Œ <strong>MX ë ˆì½”ë“œ:</strong></p>
            <ul>
                {% for mx in data["MX ë ˆì½”ë“œ"] %}
                    <li>{{ mx }}</li>
                {% endfor %}
            </ul>
            <p>ğŸ“Œ <strong>ë„¤ì„ì„œë²„:</strong></p>
            <ul>
                {% for ns in data["ë„¤ì„ì„œë²„"] %}
                    <li>{{ ns }}</li>
                {% endfor %}
            </ul>
        </div>

        <!-- ğŸ—ºï¸ ì§€ë„ -->
        <div id="map"></div>
    </div>

    <script>
        // ì§€ë„ ìƒì„±
        var map = L.map('map').setView([20, 0], 2); 

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18
        }).addTo(map);

        {% if data and data["ìœ„ë„"] is not none and data["ê²½ë„"] is not none %}
            var latitude = "{{ data["ìœ„ë„"] | default(0) }}";
            var longitude = "{{ data["ê²½ë„"] | default(0) }}";
            var domain = "{{ data['ë„ë©”ì¸'] }}";
            var country = "{{ data['ë“±ë¡êµ­ê°€'] }}";

            console.log("ğŸ“Œ ì§€ë„ ë°ì´í„°:", latitude, longitude, domain, country);

            // ğŸ› ï¸ ë¬¸ìì—´ì„ ìˆ«ìë¡œ ë³€í™˜
            latitude = parseFloat(latitude);
            longitude = parseFloat(longitude);

            if (!isNaN(latitude) && !isNaN(longitude) && latitude !== 0 && longitude !== 0) {
                var marker = L.marker([latitude, longitude]).addTo(map)
                    .bindPopup(domain + " - " + country).openPopup();

                map.setView([latitude, longitude], 4);
            } else {
                console.warn("ğŸš¨ ìœ„ë„/ê²½ë„ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŒ:", latitude, longitude);
            }
        {% endif %}
    </script>
    {% endif %}

</body>
</html>
